<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MenuMapper">

    <resultMap type="Menu" id="menuResultMap">
        <id column="MENU_ID" property="menuId"/>
        <result column="MENU_NAME" property="menuName"/>
        <result column="MENU_URL" property="menuUrl"/>
        <result column="LEAF" property="leaf"/>
        <result column="RANK" property="rank"/>
        <result column="SEQUENCE" property="sequence"/>
        <result column="ROOT_ID" property="rootId"/>
        <result column="SUP_ID" property="supId"/>
        <result column="ICON" property="icon"/>
        <result column="DISABLED" property="disabled"/>
        <result column="REMARK" property="remark"/>
    </resultMap>


    <!-- 表名 -->
    <sql id="tableName">
        T_MENU
    </sql>

    <!-- 字段 -->
    <sql id="field">
        MENU_ID,MENU_NAME,MENU_URL,LEAF,RANK,SEQUENCE,ROOT_ID,SUP_ID,ICON, DISABLED,REMARK,MODIFY_DATE,MODIFY_USERID,MODIFY_USERNAME
    </sql>

    <!-- 字段值 -->
    <sql id="fieldValue">
        #{menuId}, #{menuName}, #{menuUrl}, #{leaf}, #{rank}, #{sequence}, #{rootId}, #{supId},#{icon},#{disabled},#{remark},#{modifyDate},#{modifyUserId},#{modifyUsername}
    </sql>

    <!-- 获取菜单列表 -->
    <select id="listAllMenu" parameterType="pd" resultMap="menuResultMap">
        select <include refid="field"></include>
        from <include refid="tableName"></include>
        WHERE 1=1
    </select>

    <!-- 新增菜单 -->
    <insert id="saveMenuvity" parameterType="Menu">
        insert into T_MENU(MENU_ID,MENU_NAME,MENU_URL,LEAF,RANK,SEQUENCE,ROOT_ID,SUP_ID,ICON, DISABLED,REMARK)
        values(#{menuId},#{menuName},#{menuUrl},#{leaf},#{rank},#{sequence},#{rootId},#{supId},convert(varbinary(max),#{icon}),#{disabled},#{remark})
    </insert>

    <!-- 获取用户总数 -->
    <select id="getMenuCount" parameterType="String" resultType="pd">
        SELECT
        count(MENU_ID) menuCount
        FROM
        <include refid="tableName"></include>
    </select>

</mapper>
